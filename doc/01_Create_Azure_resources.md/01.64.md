---
title: '64: TechLab: Training AI Models on Azure VMs using Azure CycleCloud SLURM Workspace [Parent]` 
layout: default
nav_order: 64
parent: 'Lab summaries'
--- 

# Lab Metadata & Summary

**ID** 196080  
**Number:** 41-411-2  
**Name:** TechLab: Training AI Models on Azure VMs using Azure CycleCloud SLURM Workspace [Parent]  
**CloudSubscriptionPoolName:** CycleCloud CSS (Recycling)  
**AllowSave:** False  
**CloudCredentialPoolAssignments:** NA  
**Additional licenses:** NA  

---

## Exercise Summary

### Exercise 1: Deploy Slurm Workspace using a marketplace image
- Generate SSH keys and configure Azure CycleCloud Workspace deployment for Slurm.  
- Deploy the workspace with virtual networks, storage, CycleCloud VM, and Slurm cluster nodes.  
- Adjust settings: VM sizes (D4as_v4 for CycleCloud VM), networking, scheduler, login node, partitions (HTC, HPC, GPU), and disable unnecessary features.  
- Connect to the CycleCloud web app via Azure Bastion tunnel and validate scheduler and login nodes.  
- Manually add a login node if not deployed.  
- Review cluster settings, node states, and array configurations in CycleCloud portal.  

### Exercise 2: Add a GPU node and perform NCCL testing
- Connect to the cluster login node via SSH/Bastion.  
- Clone required GitHub repositories (**cyclecloud-llm**, **AI_on_Infra_Lab**) for NCCL tests and AI inference.  
- Provision a GPU node (NC24s_v3) interactively using Slurm.  
- Validate provisioning in CycleCloud portal and note GPU node details.  
- Run baseline NCCL tests without Slurm to measure operation time, bandwidth, and GPU communication.  
- Run NCCL batch tests with Slurm scheduler and compare performance with baseline.  
- Verify container support by running a PyTorch container test with Slurm.  

### Exercise 3: Load dataset and run inference with DistilBERT
- Prepare environment and dataset using AI_on_Infra_Lab scripts.  
- Edit **submit_job.sh** script to modify prompt for sentiment analysis.  
- Submit GPU batch job using Slurm (`sbatch`).  
- Monitor job status with `squeue` and review generated log files (`bert_inference.out` and `.err`).  
- Validate inference results by checking sentiment predictions on test input.  

---

## Learning Objectives
- Learn how to deploy and manage a Slurm-managed GPU cluster on Azure using CycleCloud.  
- Gain experience provisioning compute nodes and running NCCL GPU communication tests.  
- Validate containerized AI workloads on GPU-enabled clusters.  
- Perform inference with DistilBERT for real-world sentiment analysis use cases.  
