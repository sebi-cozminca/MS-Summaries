---
title: '24: TechLab: Custom Engine Agents-Build Agents for Microsoft 365 Copilot` 
layout: default
nav_order: 24
parent: 'Lab summaries'
--- 

# Lab Metadata & Summary

**ID** 186550  
**Number:** LAB911  
**Name:** TechLab: Custom Engine Agents-Build Agents for Microsoft 365 Copilot  
**CloudSubscriptionPoolName:** Microsoft CSU CSS - Recycling (Prod)  
**AllowSave:** True  
**CloudCredentialPoolAssignments:** NA  
**Additional licenses:** E3, E5【137†source】  

---

## Exercise Summary

### Exercise 1: Create a custom engine agent project
- Opened starter project in Visual Studio 2022.  
- Reviewed solution structure including Web API project and Teams Toolkit project.  

### Exercise 2: Setup Dev Tunnel
- Configured Dev Tunnel in Visual Studio to expose local bot endpoint.  
- Validated connectivity with Teams.  

### Exercise 3: Provision resources
- Used Teams Toolkit provisioning workflow (Teams app, Entra app, Azure Bot).  
- Deployed Azure OpenAI resource and integrated GPT model.  

### Exercise 4: Configure prompts and handlers
- Defined prompt templates and suggested prompts.  
- Added message handlers for keywords/phrases.  

### Exercise 5: Integrate RAG with Azure AI Search
- Connected agent to Azure AI Search for knowledge-grounded responses.  
- Implemented Retrieval Augmented Generation (RAG).  

### Exercise 6: Feedback and content safety
- Integrated feedback loop for end-users.  
- Configured Azure Content Safety for moderation of user- and AI-generated content.  
